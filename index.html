<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PCOS Quiz – Nourished Natural Health</title>
  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500&family=Fraunces:opsz,wght@9..144,500&display=swap"
    rel="stylesheet"
  />
  <!-- Klaviyo Web Tracking Snippet -->
  <script>
    (function(){
      var _learnq = window._learnq = window._learnq || [];
      if (!_learnq.init) {
        _learnq.methods = ["identify","track","trackForm","page","push","subscribe"];
        _learnq.factory = function(t){
          return function(){
            _learnq.push([t].concat(Array.prototype.slice.call(arguments,0)));
          };
        };
        for (var i=0; i<_learnq.methods.length; i++){
          _learnq[_learnq.methods[i]] = _learnq.factory(_learnq.methods[i]);
        }
        _learnq.load = function(apiKey){
          var script = document.createElement("script");
          script.type = "text/javascript";
          script.async = true;
          script.src = "https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=" + apiKey;
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(script, s);
        };
        _learnq.load("S4cYEr"); // Your public API key
        _learnq.init = true;
      }
    })();
  </script>

  <style>
    :root {
      --color-primary: #354562;
      --color-accent:  #984F1B;
      --color-text:    #000000;
      --font-heading: 'Fraunces', serif;
      --font-body:    'DM Sans', sans-serif;
      --spacing:      1rem;
    }
    *, *::before, *::after { box-sizing: border-box; }
    body { margin:0; font-family:var(--font-body); color:var(--color-text); line-height:1.5; }
    .quiz-container { max-width:480px; margin:0 auto; padding:calc(var(--spacing)*2); }
    .progress-container { width:100%; background:#e0e0e0; border-radius:4px; overflow:hidden; height:8px; margin-bottom:var(--spacing); }
    .progress-bar { width:0%; height:100%; background:var(--color-accent); transition:width .3s ease; }
    .screen { display:none; animation:fadeIn .3s ease-in; }
    .screen.active { display:block; }
    h1 { font-family:var(--font-heading); font-size:2rem; margin-bottom:var(--spacing); color:var(--color-primary); }
    h2 { font-family:var(--font-heading); font-size:1.25rem; margin-bottom:calc(var(--spacing)*0.5); color:var(--color-primary); }
    p { font-size:1rem; margin-bottom:var(--spacing); }
    .btn {
      display:block; width:100%; padding:var(--spacing);
      margin:calc(var(--spacing)*0.5) 0;
      font-size:1rem; border:none; border-radius:8px;
      background:var(--color-primary); color:#fff; cursor:pointer;
    }
    .btn-secondary { background:var(--color-accent); }
    label, input {
      display:block; width:100%; margin-bottom:var(--spacing); font-size:1rem;
    }
    input { padding:calc(var(--spacing)*0.5); border:1px solid #ccc; border-radius:4px; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(8px);} to { opacity:1; transform:translateY(0);} }
  </style>
</head>
<body>
  <div class="quiz-container">
    <!-- Progress Bar -->
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>

    <!-- 1) Cover -->
    <div class="screen active" id="screen-cover">
      <h1>Get Your Personalized Vitamin Protocol</h1>
      <p>Discover which vitamins are right for your unique PCOS type and get a free report on all the lifestyle changes you can make to get rid of your symptoms forever.</p>
      <img
        src="https://lq3-production01.s3-accelerate.amazonaws.com/lead_quizzes_3.0/cover_page/0003/93/8d42d39e57b245d87302f661b5ee17c60af511dd.jpeg"
        alt="Quiz Cover"
        loading="lazy"
        style="width:100%; border-radius:12px; margin-bottom:var(--spacing)"
      />
      <button class="btn" id="btn-start">Start Assessment</button>
    </div>

    <!-- 2) Questions 1–23 -->
    <!-- Repeat these blocks for steps 1–23 with the exact text & data-type -->
    <div class="screen" data-step="1">
      <h2>I have been diagnosed with insulin resistance, pre-diabetes, diabetes or have suspected insulin resistance</h2>
      <button class="btn" data-type="insulin">Yes</button>
      <button class="btn btn-secondary" data-type="">No</button>
    </div>
    <!-- … data-step="2" through "23" … -->
    <!-- (Copy the 23 questions exactly as before) -->

    <!-- 3) Email Capture -->
    <div class="screen" id="screen-email">
      <h2>Almost done!</h2>
      <p>Add your best contact email and we'll send the results straight to your inbox.</p>
      <label for="email">Email address</label>
      <input type="email" id="email" placeholder="you@example.com" required />
      <button class="btn" id="btn-submit-email">Submit</button>
      <p id="email-error" style="color:#c00; display:none;">Please enter a valid email.</p>
    </div>

    <!-- 4) Result -->
    <div class="screen" id="screen-result">
      <h2>Your result is ready!</h2>
      <a href="#" class="btn" id="result-link">View My Results</a>
    </div>
  </div>

  <script>
  (function(){
    const redirectMap = {
      insulin:      'https://nourishednaturalhealth.com/pages/insulin-resistant-quiz-result-v1',
      inflammatory: 'https://nourishednaturalhealth.com/pages/inflammatory-quiz-result',
      adrenal:      'https://nourishednaturalhealth.com/pages/adrenal-quiz-result',
      postpill:     'https://nourishednaturalhealth.com/pages/post-pill-quiz-result'
    };
    const resultLabels = {
      insulin:      'Insulin Resistant PCOS',
      inflammatory: 'Inflammatory PCOS',
      adrenal:      'Adrenal PCOS',
      postpill:     'Post-Pill PCOS'
    };
    const KLAV_LIST_ID = 'URJwDU';

    let scores = {}, override = false, step = 0;
    const screens = document.querySelectorAll('.screen');
    const totalSteps = 23;
    const progressBar = document.getElementById('progress-bar');

    function updateProgress() {
      progressBar.style.width = ((step / totalSteps) * 100) + '%';
    }
    function showScreen(idx) {
      screens.forEach(s=>s.classList.remove('active'));
      screens[idx].classList.add('active');
      updateProgress();
    }
    function nextStep(type) {
      if(type==='postpill') override=true;
      else if(type) scores[type]=(scores[type]||0)+1;
      step++;
      if(step<=totalSteps) showScreen(step);
      else showScreen(totalSteps+1);
    }

    document.getElementById('btn-start').addEventListener('click', ()=>{
      step=0; updateProgress(); showScreen(1);
    });

    document.querySelectorAll('[data-step] .btn').forEach(btn=>{
      btn.addEventListener('click', ()=> nextStep(btn.dataset.type));
    });

    document.getElementById('btn-submit-email').addEventListener('click', ()=>{
      const email = document.getElementById('email').value.trim();
      const err   = document.getElementById('email-error');
      if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)){
        err.style.display='block'; return;
      }
      err.style.display='none';

      const key   = override
        ? 'postpill'
        : Object.entries(scores).sort((a,b)=>b[1]-a[1])[0]?.[0]||'insulin';
      const label = resultLabels[key];

      // Identify & subscribe via Klaviyo snippet
      window._learnq.push(['identify', { email: email, source_content_result: label }]);
      window._learnq.push(['subscribe', {
        listId: KLAV_LIST_ID,
        email: email,
        properties: { source_content_result: label }
      }]);

      // Show result
      document.getElementById('result-link').href = redirectMap[key];
      showScreen(totalSteps+2);
    });
  })();
  </script>
</body>
</html>
