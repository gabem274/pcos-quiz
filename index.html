<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PCOS Quiz – Nourished Natural Health</title>

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500&family=Fraunces:opsz,wght@9..144,500&display=swap"
    rel="stylesheet"
  />

  <!-- Klaviyo Snippet -->
  <script>
    (function(){
      var _learnq = window._learnq = window._learnq || [];
      if (!_learnq.init) {
        ["identify","track","trackForm","page","subscribe"].forEach(function(m){
          _learnq[m] = function(){
            _learnq.push([m].concat(Array.prototype.slice.call(arguments,0)));
          };
        });
        var s = document.createElement("script");
        s.async = true;
        s.src = "https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=S4cYEr";
        document.head.appendChild(s);
        _learnq.init = true;
      }
    })();
  </script>

  <style>
    :root {
      --color-yes: #E51550;
      --color-secondary: #06604A;
      --color-text: #1e1b1c;
      --spacing: 1rem;
      --font-heading: 'Fraunces', serif;
      --font-body: 'DM Sans', sans-serif;
    }
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: var(--font-body);
      color: var(--color-text);
      line-height: 1.5;
    }
    .quiz-container {
      max-width: 480px;
      margin: 0 auto;
      padding: calc(var(--spacing) * 2);
    }
    .counter {
      font-size: 1rem;
      margin-bottom: var(--spacing);
      text-align: right;
    }
    .screen { display: none; }
    .screen.active { display: block; }
    h1 {
      font-family: var(--font-heading);
      font-size: 2rem;
      margin-bottom: var(--spacing);
    }
    h2 {
      font-family: var(--font-heading);
      font-size: 1.25rem;
      margin-bottom: calc(var(--spacing) * 0.5);
    }
    p { margin-bottom: var(--spacing); }
    .btn {
      display: block;
      width: 100%;
      padding: var(--spacing);
      margin: calc(var(--spacing) * 0.5) 0;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background: var(--color-yes);
      color: #fff;
      cursor: pointer;
      font-family: var(--font-body);
    }
    .btn-secondary {
      background: var(--color-secondary);
      color: #fff;
      margin-bottom: 0;
    }
    .btn-not-sure {
      background: #A93923;
      color: #fff;
      margin: calc(var(--spacing) * 0.25) 0 var(--spacing);
    }
    label, input {
      display: block;
      width: 100%;
      margin-bottom: var(--spacing);
      font-size: 1rem;
      color: var(--color-text);
    }
    input {
      padding: calc(var(--spacing) * 0.5);
      border: 1px solid #ccc;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h1>Get Your Personalized Vitamin Protocol</h1>
    <div id="counter" class="counter"></div>

    <!-- Cover -->
    <div class="screen active" id="screen-cover">
      <p>Discover which vitamins are right for your unique PCOS type and get a free report on all the lifestyle changes you can make to get rid of your symptoms forever.</p>
      <img
        src="https://lq3-production01.s3-accelerate.amazonaws.com/lead_quizzes_3.0/cover_page/0003/93/8d42d39e57b245d87302f661b5ee17c60af511dd.jpeg"
        alt="Quiz Cover"
        style="width:100%;border-radius:12px;margin-bottom:var(--spacing)"
      />
      <button type="button" id="btn-start" class="btn">Get My Personalized Plan</button>
    </div>

    <!-- Questions 1–23 -->
    <!-- (Insert your 23 question screens here; each .screen[data-step] with Yes/No/Not Sure buttons) -->

    <!-- Email Capture -->
    <div class="screen" id="screen-email">
      <h2>Almost done!</h2>
      <p>Add your best contact email and we'll send the results straight to your inbox.</p>
      <label for="email">Email address</label>
      <input id="email" type="email" placeholder="you@example.com" required />
      <button id="btn-submit-email" class="btn">Get My Personalized Plan</button>
      <p id="email-error" style="color:var(--color-secondary);display:none;">Please enter a valid email.</p>
    </div>
  </div>

  <script defer>
    const totalQuestions = 23;
    let step = 0, scores = {}, override = false;
    const screens = document.querySelectorAll('.screen'),
          qs = document.querySelectorAll('[data-step]'),
          counter = document.getElementById('counter');

    const redirectMap = {
      insulin:      'https://nourishednaturalhealth.com/pages/insulin-resistant-quiz-result-v1',
      inflammatory: 'https://nourishednaturalhealth.com/pages/inflammatory-quiz-result',
      adrenal:      'https://nourishednaturalhealth.com/pages/adrenal-quiz-result',
      postpill:     'https://nourishednaturalhealth.com/pages/post-pill-quiz-result'
    };
    const resultLabels = {
      insulin:      'Insulin Resistant PCOS',
      inflammatory: 'Inflammatory PCOS',
      adrenal:      'Adrenal PCOS',
      postpill:     'Post-Pill PCOS'
    };

    function updateCounter() {
      counter.textContent = (step > 0 && step <= totalQuestions)
        ? `Q${step}/${totalQuestions}`
        : '';
    }
    function show(idx) {
      screens.forEach(s => s.classList.remove('active'));
      screens[idx].classList.add('active');
      updateCounter();
    }
    function next(type) {
      if (type === 'postpill') override = true;
      else if (type) scores[type] = (scores[type] || 0) + 1;
      step++;
      if (step <= totalQuestions) show(step);
      else show(totalQuestions + 1);
    }

    document.getElementById('btn-start').addEventListener('click', () => {
      step = 1; show(1);
    });
    qs.forEach(q =>
      q.querySelectorAll('button').forEach(btn =>
        btn.addEventListener('click', () => next(btn.dataset.type))
      )
    );

    document.getElementById('btn-submit-email').addEventListener('click', () => {
      const email = document.getElementById('email').value.trim();
      const err = document.getElementById('email-error');
      if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
        err.style.display = 'block';
        return;
      }
      err.style.display = 'none';

      // Determine result
      const key = override
        ? 'postpill'
        : Object.entries(scores).sort((a,b) => b[1] - a[1])[0]?.[0] || 'insulin';
      const label = resultLabels[key];

      // 1) Identify & mark subscribed
      window._learnq.push(['identify', {
        email,
        source_content_result: label,
        accepts_marketing: true,
        email_status: 'subscribed'
      }]);
      // 2) Subscribe to list
      window._learnq.push(['subscribe', {
        listId: 'URJwDU',
        email,
        confirm_optin: true
      }]);

      // Auto‐redirect parent window to results page
      window.top.location.href = redirectMap[key];
    });
  </script>
</body>
</html>
